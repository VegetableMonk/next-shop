"use client"
import Image from "next/image"
import Price from "@/components/product/Price"
import useCartStore from "@/store/cartStore"
import { PopulatedProduct } from "@/lib/DAL/Models/Product"

type props = {
	product: PopulatedProduct
}

export default function CartRow({ product }: props) {
	const {
		setAmmount: ammountSetter,
		discardItem: itemDiscarder
	} = useCartStore((state) => state)
	const storeAmount = useCartStore((state) => state.items[product.id])
	const setAmmount = (amnt: number) => ammountSetter(product.id, amnt)
	const discardItem = () => itemDiscarder(product.id)
	return (
		<div
			className="
				flex justify-between h-12 w-full rounded-md
				bg-cyan-300 border-1 p-2 border-tel-300
			"
		>
			<div
				className="relative h-full aspect-square"
			>
				<Image
					alt=""
					fill
					sizes="
					(max-width:640px) 10vw
					(max-width:1024px) 5vw
				"
					src={`/products/${product.images[0]}`}
				/>
			</div>
			<h3>{product.name}</h3>
			<Price price={product.price} discount={product.discount} className="" />
			<div
				className="flex justify-between w-1/5"
			>
				<button type="button" onClick={() => setAmmount(storeAmount - 1)}>-</button>
				<span>{storeAmount}</span>
				<button type="button" onClick={() => setAmmount(storeAmount + 1)}>+</button>
				<button type="button" onClick={discardItem}>X</button>
			</div>
		</div>
	)
}
